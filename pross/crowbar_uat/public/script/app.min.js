var $edit_availability = false;

if($is_mobile_device == 'no'){
    if (Notification.permission !== "granted"){
        Notification.requestPermission();
    }
}

$(function(){
    $(document).on('focus','.datepicker input[type="text"]',function(e){
        $(this).next().trigger('click'); 
    });

    $(document).on('doubleclick','[data-request="job-actions"]',function(e){
        e.stopPropagation();
        var $this   = $(this);
        var $url    = $(this).data('url');

        $.ajax({
            url: $url, 
            cache: false, 
            contentType: false, 
            processData: false, 
            dataType: 'json', 
            type: 'get', 
            success: function($response){
                if($response.status === true){
                    $this.html($response.data.html);
                }else{
                    $this.html($response.message);
                }
            }
        }); 
    });

    if($('[data-request="job-actions"]').length > 0){
        $('[data-request="job-actions"]').trigger('doubleclick');
    }

    $(document).on('click','[data-request="favorite"]',function(){
        $('#popup').show();        
        var _this = $(this);

        $.ajax({
            url: $(this).data('url'), 
            cache: false, 
            contentType: false, 
            processData: false, 
            dataType: 'json', 
            type: 'get', 
            success: function(response){
                if(response.status === true){
                    _this.html(response.data.html);
                }
                $('#popup').hide();
            },error: function(error){
                $('#popup').hide();
            }
        }); 
    });

    $(document).on('click','[data-request="chat-initiate"]',function(){
        var $this           = $(this);
        var $url            = $this.data('url');
        var $user           = $this.data('user');

        /* SAVING CURRENT CHAT WINDOW */
        writeCookie('current_chat_window',$user);

        window.location = $url;
    });

    $(document).on('click','[data-request="send-chat-request"]',function(){
        var $this           = $(this);
        var $url            = $this.data('url');
        var $target         = $this.data('target');
        var $sender         = $this.data('sender');
        var $receiver       = $this.data('receiver');

        $.ajax({
            url: $url+'?sender='+$sender+'&receiver='+$receiver+'&html=true',
            type: 'get',
            success: function($response) {
                if($response.status === true){
                    $($target).html($response.data.html);
                }else{
                    // IF ANY ISSUE OCCUR
                }
            }
        });
    });

    $(document).on('keyup','[data-request="city-filter"]',function(){
        var $this           = $(this);
        var $url            = $this.data('url');
        var $target         = $this.data('target');
        var $selected_city  = readCookie('city-filter');
        if(!$selected_city){
            $selected_city = '';
        }
        
        if($target){
            var $handle = $($target);
        }

        $handle.parent().append('<img class="option-loader" src="'+asset_url+'/images/loader.gif">');
        
        $.ajax({
            url: $url+'?search='+$this.val()+'&selected='+$selected_city,
            type: 'get',
            success: function($response) {
                if($handle.find('.mCSB_container').length > 0){
                    $handle.find('.mCSB_container').html($response);
                }else{
                    $handle.html($response);
                }
                
                if($('[data-request="custom-scrollbar"]').length > 0){
                    setTimeout(function(){
                        $('[data-request="custom-scrollbar"]').mCustomScrollbar('update');
                    },10);
                }

                $('.option-loader').remove();
            }
        });
    });

    if($('[data-request="city-filter"]').length > 0){
        $('[data-request="city-filter"]').trigger('keyup');
    }

    $(document).on('change','[data-request="save-city-filter"]', function(){
        if($(this).prop('checked') === true){
            if(readCookie('city-filter')){
                if(readCookie('city-filter').includes($(this).val())){

                }else{
                    writeCookie('city-filter',readCookie('city-filter')+','+$(this).val());
                }
            }else{
                writeCookie('city-filter',$(this).val());
            }
        }else{
            if(readCookie('city-filter').includes($(this).val())){
                var city_filters = readCookie('city-filter').split(",");
                var filter_index = city_filters.indexOf($(this).val());

                if (filter_index > -1) {
                    city_filters.splice(filter_index, 1);
                }
                console.log(city_filters);
                writeCookie('city-filter',city_filters.join(","));
            }
        }
    });    

    $(document).on('change','[data-request="option"]',function(){
        var $this   = $(this);
        var $url    = $this.data('url');
        var $target = $this.data('target');

        if($target){
            var $handle = $($target).find('select');
        }else{
            var $handle = $this.closest('.form-group').next().find('select');
        }

        $handle.parent().append('<img class="option-loader" src="'+asset_url+'/images/loader.gif">');

        $.ajax({
            url: $url+'?record_id='+$this.val(),
            type: 'get',
            success: function($response) {
                $handle.html($response);
                $handle.trigger('change');
                $('.option-loader').remove();
            }
        });
    });

    $(document).on('click','[data-request="trigger-proposal"]', function(){
        var $this              = $(this);
        var $target            = $this.data('target');
        var $source            = $this.data('copy-source');
        var $destination       = $this.data('copy-destination');
        var fields = [];
        
        $($source).each(function(i){
            fields[i] = $(this).val();
        });

        $($destination).val(fields.join(','));

        $($target).trigger('click');
    });

    $(document).on('click','[data-request="remove-local-document"]', function(){
        var $this               = $(this);
        var $target             = $this.data('target');
        var $source             = $this.data('source');
        var $destination        = $this.data('destination');
        var fields              = [];

        if($($destination).val()){
            var fields          = ($($destination).val()).split(",");
        }

        fields[(fields.length)] = $($target).find($source).val();
        $($destination).val(fields.join(','));

        $($target).fadeOut();
        $($target).remove(); 
    });

    $(document).on('keypress keyup','[data-request="input-keyup"]', function(event){
        var $this              = $(this);
        var $target            = $this.data('target');
        var $source            = $this.data('copy-source');
        var $destination       = $this.data('paste-destination');
        
        value = $this.val();
        reduce = $($source).data('value');
        if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
            event.preventDefault();
        }
        
        calculation = eval(value)+eval(reduce);

        if(calculation){
            $($destination).val(calculation);
        }else{
            $($destination).val('');
        }
    });    


    $(document).on('click','[data-request="scroll"]', function(){
        if($(this).data('section')){
            $('html, body').animate({
                scrollTop: ($('#'+$(this).data('section')).offset().top-50)
            }, 500);            
        }
    });

    if($('[data-request="scroll"]').length > 0){
        $('[data-request="scroll"]').trigger('click');
    }

    $('[data-request="tags"]').select2({
        'tags': true,
        insertTag: function(data, tag) {
            var $found = false;
            $.each(data, function(index, value) {
                if($.trim(tag.text).toUpperCase() == $.trim(value.text).toUpperCase()) {
                    $found = true;
                }
            });

            if(!$found) data.unshift(tag);
        }
    });

    $('select').select2({
        placeholder: function(){
            $(this).find('option[value!=""]:first').html();
        }
    });

    $(document).on('change','[data-request="calendar"]',function(){
        if($edit_availability === true){
            return false;
        }

        $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();

        var $this       = $(this);
        var $url        = $this.data('url');
        var $year       = $('[name="year"]');
        var $month      = $('[name="month"]:checked');
        var $day        = $('[name="day"]:checked');

        $.ajax({
            url: $url, 
            type: 'post', 
            data: {
                'year': $year.val(),
                'month': $month.val(),
                'day': $day.val(),
            }, 
            success: function($response){
                if($response.status === false){
                    if($this.get(0).tagName === 'INPUT'){
                        $this.parent().removeClass('active');
                        $this.prop('checked',false);
                    }else{
                        $this.val("").trigger('change');
                        $('[name="month"]').prop('checked',false);
                        $('[name="month"]').parent().removeClass('active');
                        $('[name="day"]').prop('checked',false);
                        $('[name="day"]').parent().removeClass('active');
                    }
                    $this.closest('.form-group').parent().append('<div class="help-block">'+$response.message+'</div>');
                    $this.closest('.form-group').parent().addClass('has-error');
                    $this.closest('.form-group').addClass('has-error');
                }else{
                    $('.selected-date').html($response.data.selected_date);
                    $('.date-section').html($response.data.dates_html);
                }
            },error: function($error){
                  
            }
        }); 
    });

    $(document).on('change','[data-request="show-hide"]',function(){
        var $this               = $(this);
        var $condition          = $this.data('condition');
        var $target             = $this.data('target');
        var $true_condition     = $this.data('true-condition');
        var $false_condition    = $this.data('false-condition');
        
        if($(this).val() == $condition){
            $($true_condition).show();
            $($false_condition).hide();
            
            $($false_condition).find('input').attr('disabled','disabled');
            $($false_condition).find('select').attr('disabled','disabled');

            $($true_condition).find('input').removeAttr('disabled');
            $($true_condition).find('select').removeAttr('disabled');
        }else{
            $($true_condition).hide();
            $($false_condition).show();
            $($true_condition).find('input').attr('disabled','disabled');
            $($true_condition).find('select').attr('disabled','disabled');

            $($false_condition).find('input').removeAttr('disabled');
            $($false_condition).find('select').removeAttr('disabled');
        }

        if($('.employment_type_postfix').length){
            $('.employment_type_postfix').html('');
            if($this.data('tag').trim()){
                $('.employment_type_postfix').html('<small>('+($this.data('tag')).trim()+')</small>');
            }
        }

        $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        $('.select2').css({'width':'100%'});
    });

    if($('[data-request="show-hide"]').length > 0){
        $('[data-request="show-hide"]:checked').trigger('change');
    }

    $(document).on('change','[data-request="show-hide-multiple"]',function(){
        var $this               = $(this);
        var $condition          = $this.data('condition');
        var $target             = $this.data('target');
        var $true_condition     = $this.data('true-condition');
        var $false_condition    = $this.data('false-condition');
        var $one                = []; 
        var $two                = []; 
        var $index              = 0;
        
        $('[data-request="show-hide-multiple"]:checked').each(function(){
            if($(this).val() == $condition){
                $one[$index++] = $(this).val();
            }
        });

        var $index              = 0;
        $('[data-request="show-hide-multiple"]:checked').each(function(){
            if($(this).val() !== $condition){
                $two[$index++] = $(this).val();
            }
        });

        if($one.length !== 0){
            $($true_condition).show();
            $($true_condition).find('input').removeAttr('disabled');
            $($true_condition).find('select').removeAttr('disabled');
        }else{
            $($true_condition).hide();
            $($true_condition).find('input').attr('disabled','disabled');
            $($true_condition).find('select').attr('disabled','disabled');
        }

        if($two.length !== 0){
            $($false_condition).show();
            $($false_condition).find('input').removeAttr('disabled');
            $($false_condition).find('select').removeAttr('disabled');
        }else{
            $($false_condition).hide();
            $($false_condition).find('input').attr('disabled','disabled');
            $($false_condition).find('select').attr('disabled','disabled');
        }

        if($('.employment_type_postfix').length){
            $('.employment_type_postfix').html('');
            if($this.data('tag').trim()){
                $('.employment_type_postfix').html('<small>('+($this.data('tag')).trim()+')</small>');
            }
        }

        $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        $('.select2').css({'width':'100%'});
    });

    if($('[data-request="show-hide-multiple"]').length > 0){
        $('[data-request="show-hide-multiple"]').trigger('change');
    }
    
    $(document).on('click','[data-request="custom-tags"]',function(){
        var $this   = $(this);
        var $name   = $this.data('name');
        var $target = $this.data('target');
        var $source = $this.data('source');
        var $tag    = $($source).val();
        
        if($.trim($tag)){
            $($target).append('<a class="custom-tags-box-item">'+
                $.trim($tag)+
                '<img data-request="custom-tags-remove" src="'+asset_url+'/images/close-icon.png" alt="x">'+
                '<input name="'+$name+'[]" type="hidden" value="'+$.trim($tag)+'">'+
                '</a>'
            );

            $($source).val('');
        }
    });

    $(document).on('click','[data-request="custom-tags-remove"]',function(){
        $(this).parent().remove();
    });

    $(document).ready(function(){
        var $this   = $('[data-request="custom-tags"]');
        var $name   = $this.data('name');
        var $target = $this.data('target');
        var $tags   = $this.data('tags');
        
        $.each($tags, function( $index, $value ) {
            $($target).append('<a class="custom-tags-box-item">'+
                $.trim($value)+
                '<img data-request="custom-tags-remove" src="'+asset_url+'/images/close-icon.png" alt="x">'+
                '<input name="'+$name+'[]" type="hidden" value="'+$.trim($value)+'">'+
                '</a>'
            );
        }); 
    });

    $('[data-request="tags"]').select2({
        tags: true
    }).on('change', function() {
        var $selected = $(this).find('option:selected');
        var $container = $(this).siblings('.js-example-tags-container');

        var $list = $('<ul>');
        $selected.each(function(k, v) {
            var $li = $('<li class="tag-selected"><a class="destroy-tag-selected">×</a>' + $(v).text() + '</li>');
            $li.children('a.destroy-tag-selected')
            .off('click.select2-copy')
            .on('click.select2-copy', function(e) {
                var $opt = $(this).data('select2-opt');
                $opt.attr('selected', false);
                $opt.parents('select').trigger('change');
            }).data('select2-opt', $(v));
            $list.append($li);
        });
        $container.html('').append($list);
    }).trigger('change');

    $(document).on('click','[data-request="trigger"]',function(){
        var target = $(this).data('target');
        $(target).trigger('click');
    });

    $(document).on('click','[data-request="alert"]',function(){
        var $this = $(this);
        var $title = $this.data('title');
        var $message = $this.data('message');

        swal({
            title: $title,
            html: $message,
            showLoaderOnConfirm: false,
            showCancelButton: false,
            showCloseButton: false,
            allowEscapeKey: false,
            allowOutsideClick:false,
            customClass: 'swal-custom-class',
            confirmButtonText: $close_botton_text,
            cancelButtonText: $no_thanks_botton_text,
            preConfirm: function (res) {
                return new Promise(function (resolve, reject) {
                    if (res === true) {
                        resolve();              
                    }
                })
            }
        }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);

    });
    
    $(document).on('click','[data-request="confirm-ajax"]',function(){
        var $this       = $(this);
        var $title      = $this.data('title');
        var $ask        = $this.data('ask');
        var $url        = $this.data('url');
        var $receiver   = $this.data('receiver');
        var $sender     = $this.data('sender');

        swal({
            title: $title,
            html: $ask,
            showLoaderOnConfirm: false,
            showCancelButton: true,
            showCloseButton: false,
            allowEscapeKey: false,
            allowOutsideClick:false,
            customClass: 'swal-custom-class',
            confirmButtonText: $confirm_botton_text,
            cancelButtonText: $no_thanks_botton_text,
            preConfirm: function (res) {
                return new Promise(function (resolve, reject) {
                    if (res === true) {
                        $('#popup').show(); 
                        $.ajax({
                            url: $url, 
                            cache: false, 
                            contentType: false, 
                            processData: false, 
                            type: 'get', 
                            success: function($response){
                                $($this.data('target')).html($response.message);
                                $('#popup').hide();
                                
                                if($response.redirect){
                                    window.location = $response.redirect;
                                }

                                if($response.status === false){
                                    swal({
                                        title: '',
                                        html: $response.message,
                                        showLoaderOnConfirm: false,
                                        showCancelButton: false,
                                        showCloseButton: false,
                                        allowEscapeKey: false,
                                        allowOutsideClick:false,
                                        customClass: 'swal-custom-class',
                                        confirmButtonText: $close_botton_text,
                                        cancelButtonText: $cancel_botton_text,
                                        preConfirm: function (res) {
                                            return new Promise(function (resolve, reject) {
                                                if (res === true) {
                                                    resolve();              
                                                }
                                            })
                                        }
                                    }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
                                }

                                if($receiver){
                                    if(typeof socket != 'undefined'){
                                        socket.emit('send.notification.action',$receiver);
                                    }
                                }

                                if($sender){
                                    if(typeof socket != 'undefined'){
                                        socket.emit('send.notification.action',$sender);
                                    }
                                }
                            },error: function(error){
                                $('#popup').hide();
                            }
                        }); 
                        resolve();              
                    }
                })
            }
        }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
    });

    $(document).on('click','[data-request="inline-ajax"]',function(){
        $('#popup').show(); var $this = $(this);

        var $user       = $this.data('user');
        var $receiver   = $this.data('receiver');
        var $sender     = $this.data('sender');

        /* SAVING CURRENT CHAT WINDOW */
        if($user){
            writeCookie('current_chat_window',$user);
        }

        var $url = $(this).data('url');

        $.ajax({
            url: $url, 
            cache: false, 
            contentType: false, 
            processData: false, 
            type: 'get',
            success: function($response){
                $($this.data('target')).html($response.message);
                $('#popup').hide();
                
                if($response.redirect){
                    window.location = $response.redirect;
                }

                if($response.status === false){
                    swal({
                        title: 'Please stay calm..',
                        html: $response.message,
                        showLoaderOnConfirm: false,
                        showCancelButton: false,
                        showCloseButton: false,
                        allowEscapeKey: false,
                        allowOutsideClick:false,
                        customClass: 'swal-custom-class',
                        confirmButtonText: $close_botton_text,
                        cancelButtonText: $cancel_botton_text,
                        preConfirm: function (res) {
                            return new Promise(function (resolve, reject) {
                                if (res === true) {
                                    if(typeof LaravelDataTables !== 'undefined'){
                                        LaravelDataTables["dataTableBuilder"].draw();
                                    }
                                    resolve();              
                                }
                            })
                        }
                    }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
                }

                if($response.status === true){
                    if(typeof LaravelDataTables !== 'undefined'){
                        LaravelDataTables["dataTableBuilder"].draw();
                    }
                }

                if($receiver){
                    if(typeof socket != 'undefined'){
                        console.log("EMIT RECEIVER");
                        socket.emit('send.notification.action',$receiver);
                    }
                }
                if($sender){
                    if(typeof socket != 'undefined'){
                        console.log("EMIT SENDER");
                        socket.emit('send.notification.action',$sender);
                    }
                }
            },error: function(error){
                $('#popup').hide();
            }
        }); 

    });

    $(document).on('click','[data-request="ajax-submit"]',function(){
        /*REMOVING PREVIOUS ALERT AND ERROR CLASS*/
        $('#popup').show();  $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        var $this       = $(this);
        var $target     = $this.data('target');
        var $url        = $($target).attr('action');
        var $method     = $($target).attr('method');
        var $data       = new FormData($($target)[0]);
        if(!$method){ $method = 'get'; }
        
        $.ajax({ 
            url: $url, 
            data: $data,
            cache: false, 
            type: $method, 
            dataType: 'json',
            contentType: false, 
            processData: false,
            success: function($response){
                if ($response.status === true) {
                    swal({
                        title: $alert_message_text,
                        html: $response.message,
                        showLoaderOnConfirm: false,
                        showCancelButton: false,
                        showCloseButton: false,
                        allowEscapeKey: false,
                        allowOutsideClick:false,
                        customClass: 'swal-custom-class',
                        confirmButtonText: $close_botton_text,
                        cancelButtonText: $cancel_botton_text,
                        preConfirm: function (res) {
                            return new Promise(function (resolve, reject) {
                                if (res === true) {
                                    if($response.redirect){
                                        window.location = $response.redirect;
                                    }              
                                }
                            })
                        }
                    }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);

                    /*ASSIGN IF ANY DEFAULT VALUE EXISTS*/
                    if($response.data){
                        $.each($response.data, function(key,value) {
                            $("[name='"+key+"']").val(value);
                        });
                    }
                    
                    /*USELESS FOR NOW*/
                    if($response.show){
                        $.each($response.show, function(key,value) {
                            $(value).show();
                        });
                    }
                }else{
                    if($response.message.length > 0 && $response.message !== 'M0000'){
                        $('.messages').html($response.message);
                    }

                    if (Object.size($response.data) > 0) {
                        /*TO DISPLAY FORM ERROR USING .has-error class*/
                        show_validation_error($response.data);
                    }
                }
                $('#popup').hide();
            }
        }); 
    });

    $(document).on('click','[data-request="ajax-submit-job"]',function(){
        /*REMOVING PREVIOUS ALERT AND ERROR CLASS*/
        $('#popup').show();  $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        var $this       = $(this);
        var $target     = $this.data('target');
        var $url        = $($target).attr('action');
        var $method     = $($target).attr('method');
        var $data       = new FormData($($target)[0]);
        
        if(!$method){ $method = 'get'; }
        
        $.ajax({ 
            url: $url, 
            data: $data,
            cache: false, 
            type: $method, 
            dataType: 'json',
            contentType: false, 
            processData: false,
            success: function($response){
                if ($response.status === true) {

                    swal({
                        title: '',
                        html: $response.message,
                        showLoaderOnConfirm: true,
                        showCancelButton: true,
                        showCloseButton: false,
                        allowEscapeKey: false,
                        allowOutsideClick:false,
                        customClass: 'swal-custom-class',
                        confirmButtonText: $close_botton_text,
                        cancelButtonText: $cancel_botton_text,
                        preConfirm: function (res) {
                            return new Promise(function (resolve, reject) {
                                if (res === true) {
                                    if($response.redirect){
                                        window.location = $response.redirect;
                                    }              
                                }
                            })
                        }
                    }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
                    
                    /*ASSIGN IF ANY DEFAULT VALUE EXISTS*/
                    if($response.data){
                        $.each($response.data, function(key,value) {
                            $("[name='"+key+"']").val(value);
                        });
                    }
                    
                    /*USELESS FOR NOW*/
                    if($response.show){
                        $.each($response.show, function(key,value) {
                            $(value).show();
                        });
                    }
                }else{
                    if ($response.data) {
                        /*TO DISPLAY FORM ERROR USING .has-error class*/
                        show_validation_error($response.data);
                    }
                }
                $('#popup').hide();
            }
        }); 
    });

    $(document).on('click','[data-request="multi-ajax"]',function(){
        $('#popup').show();  $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        var $this           = $(this);
        var $target         = $this.data('target');
        var $url            = $($target).attr('action');
        var $method         = $($target).attr('method');
        var $data           = new FormData($($target)[0]);
        var $message        = $this.data('message');
        var id_education    = $($this.data('box-id')).val();
        var toremove        = $this.data('toremove');
        
        $.ajax({
            url:$url,
            data: $data,
            type:$method,
            cache: false,
            dataType: 'json',
            contentType: false, 
            processData: false,
            success:function($response){
                if ($response.status === true) {

                    setTimeout(function(){
                        if($response.redirect){
                            window.location = $response.redirect;
                        }
                    },1000);

                    if($response.data){
                        if(id_education){
                            $('#'+toremove+'-'+id_education).html($($response.data).html());
                            
                            if($response.message){ 
                                $('html, body').animate({
                                    scrollTop: ($('#'+toremove+'-'+id_education).offset().top-100)
                                }, 100);            
                            }
                            $('#'+toremove+'-'+id_education).fadeOut();
                            $('#'+toremove+'-'+id_education).fadeIn();
                        }else{
                            $($this.data('box')).prepend($response.data);
                            
                            if($response.message){ 
                                $('html, body').animate({
                                    scrollTop: ($($this.data('box')).offset().top-100)
                                }, 100);            
                            }
                        }
                        
                        $($target).find('input[type="checkbox"]').prop('checked', false);
                        $($target).find('input[type="radio"]').prop('checked', false);
                        $($target).find('input[type="text"]').val('');
                        $($target).find('input[type="password"]').val('');
                        $($target).find('input[type="date"]').val('');
                        $($target).find('input[type="time"]').val('');
                        $($target).find('input[type="hidden"]').val('');
                        $($target).find('textarea').val('');
                        $($target).find('select').val("").trigger('change');
                        $($target).find('label').removeClass('active');
                    }
                }else{
                    if($response.message && $message){
                        $($message).html($response.message);

                        $('html, body').animate({
                            scrollTop: ($($message).offset().top-100)
                        }, 100); 
                    }

                    if ($response.data) {
                        /*TO DISPLAY FORM ERROR USING .has-error class*/
                        show_validation_error($response.data);
                    }
                }
                $('#popup').hide();
            }
        });
    });

    $(document).on('click','[data-request="multi-ajax-calendar"]',function(){
        $('#popup').show();  $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        var $this           = $(this);
        var $target         = $this.data('target');
        var $url            = $($target).attr('action');
        var $method         = $($target).attr('method');
        var $data           = new FormData($($target)[0]);
        var $message        = $this.data('message');
        var id_education    = $($this.data('box-id')).val();
        var toremove        = $this.data('toremove');
        
        $.ajax({
            url:$url,
            data: $data,
            type:$method,
            cache: false,
            dataType: 'json',
            contentType: false, 
            processData: false,
            success:function($response){
                if ($response.status === true) {
                    swal({
                        title: '',
                        html: $this.data('success'),
                        showLoaderOnConfirm: true,
                        showCancelButton: true,
                        showCloseButton: false,
                        allowEscapeKey: false,
                        allowOutsideClick:false,
                        customClass: 'swal-custom-class',
                        confirmButtonText: $close_botton_text,
                        cancelButtonText: $cancel_botton_text,
                        preConfirm: function (res) {
                            return new Promise(function (resolve, reject) {
                                window.location = window.location;
                            })
                        }
                    }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
                }else{
                    if($response.message && $message){
                        swal({
                            title: '',
                            html: $response.message,
                            showLoaderOnConfirm: true,
                            showCancelButton: true,
                            showCloseButton: false,
                            allowEscapeKey: false,
                            allowOutsideClick:false,
                            customClass: 'swal-custom-class',
                            confirmButtonText: $close_botton_text,
                            cancelButtonText: $cancel_botton_text
                        }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
                        
                    }

                    if ($response.data) {
                        /*TO DISPLAY FORM ERROR USING .has-error class*/
                        show_validation_error($response.data);
                    }
                }
                $('#popup').hide();
            }
        });
    });

    $(document).on('change','[data-request="doc-submit"]', function(){
        $('#popup').show();  $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        var $this = $(this);
        var $target         = $this.data('target');
        var $url            = $($target).attr('action');
        var $method         = $($target).attr('method');
        var $data           = new FormData($($target)[0]);
        var after_upload    = $this.data('after-upload');
        $.ajax({
            url  : $url,
            data : $data,
            cache : false,
            type : $method,
            dataType : 'json',
            contentType : false,
            processData : false,
            success : function($response){
                if($response.status==true){
                    if($this.data('place') == 'prepend'){
                        $($this.data('toadd')).prepend($response.data);
                    }else{
                        $($this.data('toadd')).append($response.data);
                    }
                    if($this.data('single') === true){
                        $(after_upload).hide();
                    }
                }else{
                    if ($response.data) {
                        /*TO DISPLAY FORM ERROR USING .has-error class*/
                        show_validation_error($response.data);
                    }
                }
                $this.val('');
                $('#popup').hide();
            }
        });
    });

    $(document).on('click','[data-request="delete"]',function(){
        var $this           = $(this);
        var $url            = $this.data('url');
        var data_id         = $this.data($this.data('edit-id'));
        var toremove        = $this.data('toremove');
        var ask             = $this.data('ask');
        var after_upload    = $this.data('after-upload');
        swal({
            title: '',
            text: ask,
            showLoaderOnConfirm: true,
            showCancelButton: true,
            showCloseButton: false,
            allowEscapeKey: false,
            allowOutsideClick:false,
            customClass: 'swal-custom-class',
            confirmButtonText: $close_botton_text,
            cancelButtonText: $cancel_botton_text,
            preConfirm: function (res) {
                return new Promise(function (resolve, reject) {
                    if (res === true) {
                        $.ajax({
                            url         : $url,
                            type        : 'post',
                            dataType    : 'json',
                            success:function(response){
                                $('#'+toremove+'-'+data_id).fadeOut();
                                setTimeout(function(){
                                    $('#'+toremove+'-'+data_id).remove();
                                },1000);
                                if($this.data('single') === true){
                                    $(after_upload).show();
                                }
                                resolve()
                            }
                        })
                    }
                })
            }
        })
        .then(function(isConfirm){
            
        },function (dismiss){
            // console.log(dismiss);
        })
        .catch(swal.noop);
    });

    $(document).on('click','[data-request="edit"]',function(){
        var $this = $(this);
        var $url = $this.data('url');
        var id_education = $this.data($this.data('edit-id'));

        $this.closest('.addIcons').parent().parent().next().fadeOut();
        $this.closest('.addIcons').parent().parent().next().fadeIn();

        $('html, body').animate({
            scrollTop: ($this.closest('.addIcons').parent().parent().next().offset().top-50)
        }, 100);

        $.ajax({
            url     : $url,
            type    : 'post',
            dataType : 'json',
            success : function(response){
                /*ASSIGN IF ANY DEFAULT VALUE EXISTS*/
                if(response.data){
                    $.each(response.data, function(key,value) {
                        var $element = $("[name='"+key+"']").prop('tagName');

                        if($element === 'INPUT'){
                            if($("[name='"+key+"']").attr('type') == 'radio'){
                                $("[name='"+key+"'][value='"+value+"']").prop('checked',true).trigger('change');
                            }else{
                                $("[name='"+key+"']").val(value);
                            }
                        }else if($element === 'SELECT'){
                            $("[name='"+key+"']").val(value).trigger('change');
                        }else if($element === 'TEXTAREA'){
                            $("[name='"+key+"']").val(value);
                        }else{
                            $("[name='"+key+"']").val(value);
                        }

                        if(key === 'state'){
                            setTimeout(function(){
                                $("[name='"+key+"']").val(value).trigger('change');
                            },1000);
                        }
                    });
                }
            }
        })
    });

    $(document).on('click','[data-request="edit-availability"]',function(){
        $edit_availability = true;
        var $this = $(this);
        var $url = $this.data('url');
        var id_education = $this.data($this.data('edit-id'));

        $this.closest('.availability-box').next().next().fadeOut();
        $this.closest('.availability-box').next().next().fadeIn();

        $('html, body').animate({
            scrollTop: ($this.closest('.availability-box').next().next().offset().top-50)
        }, 100);

        $.ajax({
            url     : $url,
            type    : 'post',
            dataType : 'json',
            success : function(response){
                $('label.active').removeClass('active');
                /*ASSIGN IF ANY DEFAULT VALUE EXISTS*/
                $('.weekly-availability-section').hide();
                if(response.data){
                    $.each(response.data, function(key,value) {
                        var $element = $("[name='"+key+"']").prop('tagName');

                        if($element === 'INPUT'){
                            if($("[name='"+key+"']").attr('type') == 'radio'){
                                $("[name='"+key+"'][value='"+value+"']").prop('checked',true);
                                $("[name='"+key+"']:checked").parent().addClass('active');

                            }else if($("[name='"+key+"']").attr('type') == 'checkbox'){

                            }else{
                                $("[name='"+key+"']").val(value);
                            }
                        }else if($element === 'SELECT'){
                            $("[name='"+key+"']").val(value).trigger('change');
                        }else if($element === 'TEXTAREA'){
                            $("[name='"+key+"']").val(value);
                        }else{
                            $("[name='"+key+"']").val(value);
                        }

                        if(key == 'selected-date'){
                            $('.selected-date').html(value);
                        }

                        if(key == 'availability_day'){
                            value.forEach(function(item) {
                                $("#availability-day-"+item).parent().addClass('active');
                                $("#availability-day-"+item).prop('checked', true);
                                console.log($("#availability-day-"+item).val());
                                console.log(item);
                                console.log($("#availability-day-"+item).is('checked'));
                            });
                        }

                        if(key == 'repeat' && value == 'weekly'){
                            $('.weekly-availability-section').show();
                        }
                    });
                }
            }
        })
    });

    $(document).on('click','[data-request="ajax-modal"]',function(e){
        $('#popup').show();
        var $this       = $(this);
        var $target     = $this.data('target'); 
        var $url        = $this.data('url');

        $.ajax({
            url: $url, 
            type: 'get', 
            success: function($response){
                $('#popup').hide();
                $($target).html($response);
                $($target).modal({show:true});
            },error: function(error){
                
            }
        }); 
    });

    $(document).on('click','[data-request="paginate"]',function(e){
        $('.pager').show();
        
        var url         = $(this).data('url');
        var target      = $(this).data('target');
        var showing     = $(this).data('showing');
        var loadmore    = $(this).data('loadmore');
        
        $.ajax({
            url: url, 
            cache: false, 
            contentType: false, 
            processData: false, 
            dataType: 'json', 
            type: 'get', 
            success: function(data){
                $(target).append(data.data);
                $(showing).html('Showing '+(data.recordsFiltered)+' pending request(s) of total '+(data.recordsTotal)+' request(s). &nbsp;&nbsp;&nbsp;&nbsp;');
                $(loadmore).html(data.loadMore);
                $('.pager').hide();
            },error: function(error){
                $('.pager').hide();
            }
        }); 
    });

    $(document).on('click','[data-request="delete-card"]',function(){
        $('#popup').show(); var $this = $(this);

        $.ajax({
            url: $(this).data('url'), 
            cache: false, 
            contentType: false, 
            processData: false, 
            type: 'get', 
            success: function($response){
                $('#popup').hide();
                
                $this.closest('.removable-box').remove();
                $($this.data('target')).html($response.data.html);
                
                if($response.data.is_card_available === false){
                    $("[data-target='#add-cards']").trigger('click');
                }
                
                if($response.status === false){
                    swal({
                        title: 'Please stay calm..',
                        html: $response.message,
                        showLoaderOnConfirm: false,
                        showCancelButton: false,
                        showCloseButton: false,
                        allowEscapeKey: false,
                        allowOutsideClick:false,
                        customClass: 'swal-custom-class',
                        confirmButtonText: $close_botton_text,
                        cancelButtonText: $cancel_botton_text,
                        preConfirm: function (res) {
                            return new Promise(function (resolve, reject) {
                                if (res === true) {
                                    resolve();              
                                }
                            })
                        }
                    }).then(function(isConfirm){},function (dismiss){}).catch(swal.noop);
                }
            },error: function(error){
                $('#popup').hide();
            }
        }); 

    });

    $(document).on('click','[data-request="add-card"]',function(){
        /*REMOVING PREVIOUS ALERT AND ERROR CLASS*/
        $('#popup').show();  $('.alert').remove(); $(".has-error").removeClass('has-error');$('.help-block').remove();
        var $this       = $(this);
        var $target     = $this.data('target');
        var $url        = $($target).attr('action');
        var $method     = $($target).attr('method');
        var $data       = new FormData($($target)[0]);
        if(!$method){ $method = 'get'; }
        
        $.ajax({ 
            url: $url, 
            data: $data,
            cache: false, 
            type: $method, 
            dataType: 'json',
            contentType: false, 
            processData: false,
            success: function($response){
                $('#popup').hide();

                if ($response.status === true) {
                    $($this.data('content')).html($response.data.html);
                    
                    if($this.data('callback')){
                        $($this.data('callback')).trigger('click');
                    }
                    
                    if($this.data('dismiss')){
                        $($this.data('dismiss')).modal('toggle');
                    }
                    if($response.redirect == true){
                        window.location = window.location;
                    }
                }else{
                    if($response.message.length > 0){
                        $('.messages').html($response.message);
                    }

                    if (Object.size($response.data) > 0) {
                        /*TO DISPLAY FORM ERROR USING .has-error class*/
                        show_validation_error($response.data);
                    }
                }
                
            }
        }); 
    });

    if($('[data-request="paginate"]').length > 0){
        $('[data-request="paginate"]').trigger('click');
    }

    if($(".proposal-found-then > div").length <= 0){
        $('.not-found-then').hide();
    }


    setTimeout(function(){
        if(typeof fancybox != 'undefined'){
            if($('.fancybox').length > 0){
                $('.fancybox').fancybox({
                    'padding'       :  0,
                    'title'         : false,
                    'type'          : 'image',
                    'fitToView'     : true,
                    'autoSize'      : true,
                    'helpers'       : { 'overlay' : { 'locked' : false } },
                    beforeLoad: function(){
                      $('body').addClass('no-transform');
                    },
                    afterClose: function(){
                      $('body').removeClass('no-transform');
                    }
                });
            }
        }
    },3000);

    if(typeof socket != 'undefined'){
        /*setInterval(function(){
            socket.emit('send.notification');
        }, 120000); */
    }

    $(document).on('click','[data-request="status-request"]',function(){
        $('.alert').remove();

        var $url            = $(this).data('url');
        var $ask             = $(this).data('ask');

        var r = confirm($ask);
        if(r == true){
            $('#popup').show();
            $.ajax({
                method: "POST",
                url: $url,
            }).done(function(response) {
                if(response.status === true){
                    LaravelDataTables["dataTableBuilder"].draw();
                }else{
                    window.location = window.location;
                }
            }).always(function() {
                $('#popup').hide();
            });
        }else{
            return false;
        }
    });    
});

function show_validation_error(msg) {
    if ($.isPlainObject(msg)) {
        $data = msg;
    }else {
        $data = $.parseJSON(msg);
    }
    
    $.each($data, function (index, value) {
        var name    = index.replace(/\./g, '][');
        
        if (index.indexOf('.') !== -1) {
            name = name + ']';
            name = name.replace(']', '');
        }
        if (name.indexOf('[]') !== -1) {
            $('form [name="' + name + '"]').last().closest('.form-group').addClass('has-error');
            $('form [name="' + name + '"]').last().closest('.form-group').find('.message-group').append('<div class="help-block">' + value + '</div>');
        }else{
            if($('form [name="' + name + '"]').attr('type') == 'checkbox' || $('form [name="' + name + '"]').attr('type') == 'radio'){
                if($('form [name="' + name + '"]').attr('type') == 'checkbox'){
                    $('form [name="' + name + '"]').closest('.form-group').addClass('has-error');
                    $('form [name="' + name + '"]').parent().after('<div class="help-block">' + value + '</div>');
                }else{
                    $('form [name="' + name + '"]').closest('.form-group').addClass('has-error');
                    $('form [name="' + name + '"]').parent().parent().append('<div class="help-block">' + value + '</div>');
                }
            }else if($('form [name="' + name + '"]').get(0)){
                if($('form [name="' + name + '"]').get(0).tagName == 'SELECT'){
                    $('form [name="' + name + '"]').closest('.form-group').addClass('has-error');
                    $('form [name="' + name + '"]').parent().after('<div class="help-block">' + value + '</div>');
                }else{
                    $('form [name="' + name + '"]').closest('.form-group').addClass('has-error');
                    $('form [name="' + name + '"]').after('<div class="help-block">' + value + '</div>');
                }
            }else{
                $('form [name="' + name + '"]').closest('.form-group').addClass('has-error');
                $('form [name="' + name + '"]').after('<div class="help-block">' + value + '</div>');
            }
        }

        // $('.help-block').html($('.help-block').text().replace(".,",". "));
    });

    /*SCROLLING TO THE INPUT BOX*/
    scroll();
}

Object.size = function(obj) {
    var size = 0, key;
    for (key in obj) {
        if (obj.hasOwnProperty(key)) size++;
    }
    return size;
};

(function($){
    $(window).on("load",function(){
        setTimeout(function(){
            if($('[data-request="custom-scrollbar"]').length > 0){
                $('[data-request="custom-scrollbar"]').mCustomScrollbar();
            }
        },200);
    });
})(jQuery);

$(window).on('load resize',  function(){
    $('select').css('width', "100%");
});


function show_validation_error(t){$.isPlainObject(t)?$data=t:$data=$.parseJSON(t),$.each($data,function(t,e){var a=t.replace(/\./g,"][");-1!==t.indexOf(".")&&(a+="]",a=a.replace("]","")),-1!==a.indexOf("[]")?($('form [name="'+a+'"]').last().closest(".form-group").addClass("has-error"),$('form [name="'+a+'"]').last().closest(".form-group").find(".message-group").append('<div class="help-block">'+e+"</div>")):"checkbox"==$('form [name="'+a+'"]').attr("type")||"radio"==$('form [name="'+a+'"]').attr("type")?"checkbox"==$('form [name="'+a+'"]').attr("type")?($('form [name="'+a+'"]').closest(".form-group").addClass("has-error"),$('form [name="'+a+'"]').parent().after('<div class="help-block">'+e+"</div>")):($('form [name="'+a+'"]').closest(".form-group").addClass("has-error"),$('form [name="'+a+'"]').parent().parent().append('<div class="help-block">'+e+"</div>")):$('form [name="'+a+'"]').get(0)&&"SELECT"==$('form [name="'+a+'"]').get(0).tagName?($('form [name="'+a+'"]').closest(".form-group").addClass("has-error"),$('form [name="'+a+'"]').parent().after('<div class="help-block">'+e+"</div>")):($('form [name="'+a+'"]').closest(".form-group").addClass("has-error"),$('form [name="'+a+'"]').after('<div class="help-block">'+e+"</div>"))}),scroll()}function scroll(){$(".has-error").not(".modal .has-error").length>0&&$("html, body").animate({scrollTop:$(".has-error").offset().top-100},200)}var $edit_availability=!1;"no"==$is_mobile_device&&"granted"!==Notification.permission&&Notification.requestPermission(),$(function(){$(document).on("focus",'.datepicker input[type="text"]',function(t){$(this).next().trigger("click")}),$(document).on("doubleclick",'[data-request="job-actions"]',function(t){t.stopPropagation();var e=$(this),a=$(this).data("url");$.ajax({url:a,cache:!1,contentType:!1,processData:!1,dataType:"json",type:"get",success:function(t){t.status===!0?e.html(t.data.html):e.html(t.message)}})}),$('[data-request="job-actions"]').length>0&&$('[data-request="job-actions"]').trigger("doubleclick"),$(document).on("click",'[data-request="favorite"]',function(){$("#popup").show();var t=$(this);$.ajax({url:$(this).data("url"),cache:!1,contentType:!1,processData:!1,dataType:"json",type:"get",success:function(e){e.status===!0&&t.html(e.data.html),$("#popup").hide()},error:function(t){$("#popup").hide()}})}),$(document).on("click",'[data-request="chat-initiate"]',function(){var t=$(this),e=t.data("url"),a=t.data("user");writeCookie("current_chat_window",a),window.location=e}),$(document).on("click",'[data-request="send-chat-request"]',function(){var t=$(this),e=t.data("url"),a=t.data("target"),o=t.data("sender"),n=t.data("receiver");$.ajax({url:e+"?sender="+o+"&receiver="+n+"&html=true",type:"get",success:function(t){t.status===!0&&$(a).html(t.data.html)}})}),$(document).on("keyup",'[data-request="city-filter"]',function(){var t=$(this),e=t.data("url"),a=t.data("target"),o=readCookie("city-filter");if(o||(o=""),a)var n=$(a);n.parent().append('<img class="option-loader" src="'+asset_url+'/images/loader.gif">'),$.ajax({url:e+"?search="+t.val()+"&selected="+o,type:"get",success:function(t){n.find(".mCSB_container").length>0?n.find(".mCSB_container").html(t):n.html(t),$('[data-request="custom-scrollbar"]').length>0&&setTimeout(function(){$('[data-request="custom-scrollbar"]').mCustomScrollbar("update")},10),$(".option-loader").remove()}})}),$('[data-request="city-filter"]').length>0&&$('[data-request="city-filter"]').trigger("keyup"),$(document).on("change",'[data-request="save-city-filter"]',function(){if($(this).prop("checked")===!0)readCookie("city-filter")?readCookie("city-filter").includes($(this).val())||writeCookie("city-filter",readCookie("city-filter")+","+$(this).val()):writeCookie("city-filter",$(this).val());else if(readCookie("city-filter").includes($(this).val())){var t=readCookie("city-filter").split(","),e=t.indexOf($(this).val());e>-1&&t.splice(e,1),console.log(t),writeCookie("city-filter",t.join(","))}}),$(document).on("change",'[data-request="option"]',function(){var t=$(this),e=t.data("url"),a=t.data("target");if(a)var o=$(a).find("select");else var o=t.closest(".form-group").next().find("select");o.parent().append('<img class="option-loader" src="'+asset_url+'/images/loader.gif">'),$.ajax({url:e+"?record_id="+t.val(),type:"get",success:function(t){o.html(t),o.trigger("change"),$(".option-loader").remove()}})}),$(document).on("click",'[data-request="trigger-proposal"]',function(){var t=$(this),e=t.data("target"),a=t.data("copy-source"),o=t.data("copy-destination"),n=[];$(a).each(function(t){n[t]=$(this).val()}),$(o).val(n.join(",")),$(e).trigger("click")}),$(document).on("click",'[data-request="remove-local-document"]',function(){var t=$(this),e=t.data("target"),a=t.data("source"),o=t.data("destination"),n=[];if($(o).val())var n=$(o).val().split(",");n[n.length]=$(e).find(a).val(),$(o).val(n.join(",")),$(e).fadeOut(),$(e).remove()}),$(document).on("keypress keyup",'[data-request="input-keyup"]',function(event){var $this=$(this),$target=$this.data("target"),$source=$this.data("copy-source"),$destination=$this.data("paste-destination");value=$this.val(),reduce=$($source).data("value"),46==event.which&&-1==$(this).val().indexOf(".")||!(event.which<48||event.which>57)||event.preventDefault(),calculation=eval(value)+eval(reduce),calculation?$($destination).val(calculation):$($destination).val("")}),$(document).on("click",'[data-request="scroll"]',function(){$(this).data("section")&&$("html, body").animate({scrollTop:$("#"+$(this).data("section")).offset().top-50},500)}),$('[data-request="scroll"]').length>0&&$('[data-request="scroll"]').trigger("click"),$('[data-request="tags"]').select2({tags:!0,insertTag:function(t,e){var a=!1;$.each(t,function(t,o){$.trim(e.text).toUpperCase()==$.trim(o.text).toUpperCase()&&(a=!0)}),a||t.unshift(e)}}),$("select").select2({placeholder:function(){$(this).find('option[value!=""]:first').html()}}),$(document).on("change",'[data-request="calendar"]',function(){if($edit_availability===!0)return!1;$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("url"),a=$('[name="year"]'),o=$('[name="month"]:checked'),n=$('[name="day"]:checked');$.ajax({url:e,type:"post",data:{year:a.val(),month:o.val(),day:n.val()},success:function(e){e.status===!1?("INPUT"===t.get(0).tagName?(t.parent().removeClass("active"),t.prop("checked",!1)):(t.val("").trigger("change"),$('[name="month"]').prop("checked",!1),$('[name="month"]').parent().removeClass("active"),$('[name="day"]').prop("checked",!1),$('[name="day"]').parent().removeClass("active")),t.closest(".form-group").parent().append('<div class="help-block">'+e.message+"</div>"),t.closest(".form-group").parent().addClass("has-error"),t.closest(".form-group").addClass("has-error")):($(".selected-date").html(e.data.selected_date),$(".date-section").html(e.data.dates_html))},error:function(t){}})}),$(document).on("change",'[data-request="show-hide"]',function(){var t=$(this),e=t.data("condition"),a=(t.data("target"),t.data("true-condition")),o=t.data("false-condition");$(this).val()==e?($(a).show(),$(o).hide(),$(o).find("input").attr("disabled","disabled"),$(o).find("select").attr("disabled","disabled"),$(a).find("input").removeAttr("disabled"),$(a).find("select").removeAttr("disabled")):($(a).hide(),$(o).show(),$(a).find("input").attr("disabled","disabled"),$(a).find("select").attr("disabled","disabled"),$(o).find("input").removeAttr("disabled"),$(o).find("select").removeAttr("disabled")),$(".employment_type_postfix").length&&($(".employment_type_postfix").html(""),t.data("tag").trim()&&$(".employment_type_postfix").html("<small>("+t.data("tag").trim()+")</small>")),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove(),$(".select2").css({width:"100%"})}),$('[data-request="show-hide"]').length>0&&$('[data-request="show-hide"]:checked').trigger("change"),$(document).on("change",'[data-request="show-hide-multiple"]',function(){var t=$(this),e=t.data("condition"),a=(t.data("target"),t.data("true-condition")),o=t.data("false-condition"),n=[],s=[],i=0;$('[data-request="show-hide-multiple"]:checked').each(function(){$(this).val()==e&&(n[i++]=$(this).val())});var i=0;$('[data-request="show-hide-multiple"]:checked').each(function(){$(this).val()!==e&&(s[i++]=$(this).val())}),0!==n.length?($(a).show(),$(a).find("input").removeAttr("disabled"),$(a).find("select").removeAttr("disabled")):($(a).hide(),$(a).find("input").attr("disabled","disabled"),$(a).find("select").attr("disabled","disabled")),0!==s.length?($(o).show(),$(o).find("input").removeAttr("disabled"),$(o).find("select").removeAttr("disabled")):($(o).hide(),$(o).find("input").attr("disabled","disabled"),$(o).find("select").attr("disabled","disabled")),$(".employment_type_postfix").length&&($(".employment_type_postfix").html(""),t.data("tag").trim()&&$(".employment_type_postfix").html("<small>("+t.data("tag").trim()+")</small>")),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove(),$(".select2").css({width:"100%"})}),$('[data-request="show-hide-multiple"]').length>0&&$('[data-request="show-hide-multiple"]').trigger("change"),$(document).on("click",'[data-request="custom-tags"]',function(){var t=$(this),e=t.data("name"),a=t.data("target"),o=t.data("source"),n=$(o).val();$.trim(n)&&($(a).append('<a class="custom-tags-box-item">'+$.trim(n)+'<img data-request="custom-tags-remove" src="'+asset_url+'/images/close-icon.png" alt="x"><input name="'+e+'[]" type="hidden" value="'+$.trim(n)+'"></a>'),$(o).val(""))}),$(document).on("click",'[data-request="custom-tags-remove"]',function(){$(this).parent().remove()}),$(document).ready(function(){var t=$('[data-request="custom-tags"]'),e=t.data("name"),a=t.data("target"),o=t.data("tags");$.each(o,function(t,o){$(a).append('<a class="custom-tags-box-item">'+$.trim(o)+'<img data-request="custom-tags-remove" src="'+asset_url+'/images/close-icon.png" alt="x"><input name="'+e+'[]" type="hidden" value="'+$.trim(o)+'"></a>')})}),$('[data-request="tags"]').select2({tags:!0}).on("change",function(){var t=$(this).find("option:selected"),e=$(this).siblings(".js-example-tags-container"),a=$("<ul>");t.each(function(t,e){var o=$('<li class="tag-selected"><a class="destroy-tag-selected">×</a>'+$(e).text()+"</li>");o.children("a.destroy-tag-selected").off("click.select2-copy").on("click.select2-copy",function(t){var e=$(this).data("select2-opt");e.attr("selected",!1),e.parents("select").trigger("change")}).data("select2-opt",$(e)),a.append(o)}),e.html("").append(a)}).trigger("change"),$(document).on("click",'[data-request="trigger"]',function(){var t=$(this).data("target");$(t).trigger("click")}),$(document).on("click",'[data-request="alert"]',function(){var t=$(this),e=t.data("title"),a=t.data("message");swal({title:e,html:a,showLoaderOnConfirm:!1,showCancelButton:!1,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$no_thanks_botton_text,preConfirm:function(t){return new Promise(function(e,a){t===!0&&e()})}}).then(function(t){},function(t){})["catch"](swal.noop)}),$(document).on("click",'[data-request="confirm-ajax"]',function(){var t=$(this),e=t.data("title"),a=t.data("ask"),o=t.data("url"),n=t.data("receiver"),s=t.data("sender");swal({title:e,html:a,showLoaderOnConfirm:!1,showCancelButton:!0,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$confirm_botton_text,cancelButtonText:$no_thanks_botton_text,preConfirm:function(e){return new Promise(function(a,i){e===!0&&($("#popup").show(),$.ajax({url:o,cache:!1,contentType:!1,processData:!1,type:"get",success:function(e){$(t.data("target")).html(e.message),$("#popup").hide(),e.redirect&&(window.location=e.redirect),e.status===!1&&swal({title:"",html:e.message,showLoaderOnConfirm:!1,showCancelButton:!1,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(t){return new Promise(function(e,a){t===!0&&e()})}}).then(function(t){},function(t){})["catch"](swal.noop),n&&"undefined"!=typeof socket&&socket.emit("send.notification.action",n),s&&"undefined"!=typeof socket&&socket.emit("send.notification.action",s)},error:function(t){$("#popup").hide()}}),a())})}}).then(function(t){},function(t){})["catch"](swal.noop)}),$(document).on("click",'[data-request="inline-ajax"]',function(){$("#popup").show();var t=$(this),e=t.data("user"),a=t.data("receiver"),o=t.data("sender");e&&writeCookie("current_chat_window",e);var n=$(this).data("url");$.ajax({url:n,cache:!1,contentType:!1,processData:!1,type:"get",success:function(e){$(t.data("target")).html(e.message),$("#popup").hide(),e.redirect&&(window.location=e.redirect),e.status===!1&&swal({title:"Please stay calm..",html:e.message,showLoaderOnConfirm:!1,showCancelButton:!1,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(t){return new Promise(function(e,a){t===!0&&("undefined"!=typeof LaravelDataTables&&LaravelDataTables.dataTableBuilder.draw(),e())})}}).then(function(t){},function(t){})["catch"](swal.noop),e.status===!0&&"undefined"!=typeof LaravelDataTables&&LaravelDataTables.dataTableBuilder.draw(),a&&"undefined"!=typeof socket&&(console.log("EMIT RECEIVER"),socket.emit("send.notification.action",a)),o&&"undefined"!=typeof socket&&(console.log("EMIT SENDER"),socket.emit("send.notification.action",o))},error:function(t){$("#popup").hide()}})}),$(document).on("click",'[data-request="ajax-submit"]',function(){$("#popup").show(),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("target"),a=$(e).attr("action"),o=$(e).attr("method"),n=new FormData($(e)[0]);o||(o="get"),$.ajax({url:a,data:n,cache:!1,type:o,dataType:"json",contentType:!1,processData:!1,success:function(t){t.status===!0?(swal({title:$alert_message_text,html:t.message,showLoaderOnConfirm:!1,showCancelButton:!1,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(e){return new Promise(function(a,o){e===!0&&t.redirect&&(window.location=t.redirect)})}}).then(function(t){},function(t){})["catch"](swal.noop),t.data&&$.each(t.data,function(t,e){$("[name='"+t+"']").val(e)}),t.show&&$.each(t.show,function(t,e){$(e).show()})):(t.message.length>0&&"M0000"!==t.message&&$(".messages").html(t.message),Object.size(t.data)>0&&show_validation_error(t.data)),$("#popup").hide()}})}),$(document).on("click",'[data-request="ajax-submit-job"]',function(){$("#popup").show(),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("target"),a=$(e).attr("action"),o=$(e).attr("method"),n=new FormData($(e)[0]);o||(o="get"),$.ajax({url:a,data:n,cache:!1,type:o,dataType:"json",contentType:!1,processData:!1,success:function(t){t.status===!0?(swal({title:"",html:t.message,showLoaderOnConfirm:!0,showCancelButton:!0,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(e){return new Promise(function(a,o){e===!0&&t.redirect&&(window.location=t.redirect)})}}).then(function(t){},function(t){})["catch"](swal.noop),t.data&&$.each(t.data,function(t,e){$("[name='"+t+"']").val(e)}),t.show&&$.each(t.show,function(t,e){$(e).show()})):t.data&&show_validation_error(t.data),$("#popup").hide()}})}),$(document).on("click",'[data-request="multi-ajax"]',function(){$("#popup").show(),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("target"),a=$(e).attr("action"),o=$(e).attr("method"),n=new FormData($(e)[0]),s=t.data("message"),i=$(t.data("box-id")).val(),c=t.data("toremove");$.ajax({url:a,data:n,type:o,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(a){a.status===!0?(setTimeout(function(){a.redirect&&(window.location=a.redirect)},1e3),a.data&&(i?($("#"+c+"-"+i).html($(a.data).html()),a.message&&$("html, body").animate({scrollTop:$("#"+c+"-"+i).offset().top-100},100),$("#"+c+"-"+i).fadeOut(),$("#"+c+"-"+i).fadeIn()):($(t.data("box")).prepend(a.data),a.message&&$("html, body").animate({scrollTop:$(t.data("box")).offset().top-100},100)),$(e).find('input[type="checkbox"]').prop("checked",!1),$(e).find('input[type="radio"]').prop("checked",!1),$(e).find('input[type="text"]').val(""),$(e).find('input[type="password"]').val(""),$(e).find('input[type="date"]').val(""),$(e).find('input[type="time"]').val(""),$(e).find('input[type="hidden"]').val(""),$(e).find("textarea").val(""),$(e).find("select").val("").trigger("change"),$(e).find("label").removeClass("active"))):(a.message&&s&&($(s).html(a.message),$("html, body").animate({scrollTop:$(s).offset().top-100},100)),a.data&&show_validation_error(a.data)),$("#popup").hide()}})}),$(document).on("click",'[data-request="multi-ajax-calendar"]',function(){$("#popup").show(),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("target"),a=$(e).attr("action"),o=$(e).attr("method"),n=new FormData($(e)[0]),s=t.data("message");$(t.data("box-id")).val(),t.data("toremove");$.ajax({url:a,data:n,type:o,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(e){e.status===!0?swal({title:"",html:t.data("success"),showLoaderOnConfirm:!0,showCancelButton:!0,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(t){return new Promise(function(t,e){window.location=window.location})}}).then(function(t){},function(t){})["catch"](swal.noop):(e.message&&s&&swal({title:"",html:e.message,showLoaderOnConfirm:!0,showCancelButton:!0,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text}).then(function(t){},function(t){})["catch"](swal.noop),e.data&&show_validation_error(e.data)),$("#popup").hide()}})}),$(document).on("change",'[data-request="doc-submit"]',function(){$("#popup").show(),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("target"),a=$(e).attr("action"),o=$(e).attr("method"),n=new FormData($(e)[0]),s=t.data("after-upload");$.ajax({url:a,data:n,cache:!1,type:o,dataType:"json",contentType:!1,processData:!1,success:function(e){1==e.status?("prepend"==t.data("place")?$(t.data("toadd")).prepend(e.data):$(t.data("toadd")).append(e.data),t.data("single")===!0&&$(s).hide()):e.data&&show_validation_error(e.data),t.val(""),$("#popup").hide()}})}),$(document).on("click",'[data-request="delete"]',function(){var t=$(this),e=t.data("url"),a=t.data(t.data("edit-id")),o=t.data("toremove"),n=t.data("ask"),s=t.data("after-upload");swal({title:"",text:n,showLoaderOnConfirm:!0,showCancelButton:!0,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(n){return new Promise(function(i,c){n===!0&&$.ajax({url:e,type:"post",dataType:"json",success:function(e){$("#"+o+"-"+a).fadeOut(),setTimeout(function(){$("#"+o+"-"+a).remove()},1e3),t.data("single")===!0&&$(s).show(),i()}})})}}).then(function(t){},function(t){})["catch"](swal.noop)}),$(document).on("click",'[data-request="edit"]',function(){var t=$(this),e=t.data("url");t.data(t.data("edit-id"));t.closest(".addIcons").parent().parent().next().fadeOut(),t.closest(".addIcons").parent().parent().next().fadeIn(),$("html, body").animate({scrollTop:t.closest(".addIcons").parent().parent().next().offset().top-50},100),$.ajax({url:e,type:"post",dataType:"json",success:function(t){t.data&&$.each(t.data,function(t,e){var a=$("[name='"+t+"']").prop("tagName");"INPUT"===a?"radio"==$("[name='"+t+"']").attr("type")?$("[name='"+t+"'][value='"+e+"']").prop("checked",!0).trigger("change"):$("[name='"+t+"']").val(e):"SELECT"===a?$("[name='"+t+"']").val(e).trigger("change"):"TEXTAREA"===a?$("[name='"+t+"']").val(e):$("[name='"+t+"']").val(e),"state"===t&&setTimeout(function(){$("[name='"+t+"']").val(e).trigger("change")},1e3)})}})}),$(document).on("click",'[data-request="edit-availability"]',function(){$edit_availability=!0;var t=$(this),e=t.data("url");t.data(t.data("edit-id"));t.closest(".availability-box").next().next().fadeOut(),t.closest(".availability-box").next().next().fadeIn(),$("html, body").animate({scrollTop:t.closest(".availability-box").next().next().offset().top-50},100),$.ajax({url:e,type:"post",dataType:"json",success:function(t){$("label.active").removeClass("active"),$(".weekly-availability-section").hide(),t.data&&$.each(t.data,function(t,e){var a=$("[name='"+t+"']").prop("tagName");"INPUT"===a?"radio"==$("[name='"+t+"']").attr("type")?($("[name='"+t+"'][value='"+e+"']").prop("checked",!0),$("[name='"+t+"']:checked").parent().addClass("active")):"checkbox"==$("[name='"+t+"']").attr("type")||$("[name='"+t+"']").val(e):"SELECT"===a?$("[name='"+t+"']").val(e).trigger("change"):"TEXTAREA"===a?$("[name='"+t+"']").val(e):$("[name='"+t+"']").val(e),"selected-date"==t&&$(".selected-date").html(e),"availability_day"==t&&e.forEach(function(t){$("#availability-day-"+t).parent().addClass("active"),$("#availability-day-"+t).prop("checked",!0),console.log($("#availability-day-"+t).val()),console.log(t),console.log($("#availability-day-"+t).is("checked"))}),"repeat"==t&&"weekly"==e&&$(".weekly-availability-section").show()})}})}),$(document).on("click",'[data-request="ajax-modal"]',function(t){$("#popup").show();var e=$(this),a=e.data("target"),o=e.data("url");$.ajax({url:o,type:"get",success:function(t){$("#popup").hide(),$(a).html(t),$(a).modal({show:!0})},error:function(t){}})}),$(document).on("click",'[data-request="paginate"]',function(t){$(".pager").show();var e=$(this).data("url"),a=$(this).data("target"),o=$(this).data("showing"),n=$(this).data("loadmore");$.ajax({url:e,cache:!1,contentType:!1,processData:!1,dataType:"json",type:"get",success:function(t){$(a).append(t.data),$(o).html("Showing "+t.recordsFiltered+" pending request(s) of total "+t.recordsTotal+" request(s). &nbsp;&nbsp;&nbsp;&nbsp;"),$(n).html(t.loadMore),$(".pager").hide()},error:function(t){$(".pager").hide()}})}),$(document).on("click",'[data-request="delete-card"]',function(){$("#popup").show();var t=$(this);$.ajax({url:$(this).data("url"),cache:!1,contentType:!1,processData:!1,type:"get",success:function(e){$("#popup").hide(),t.closest(".removable-box").remove(),$(t.data("target")).html(e.data.html),e.data.is_card_available===!1&&$("[data-target='#add-cards']").trigger("click"),e.status===!1&&swal({title:"Please stay calm..",html:e.message,showLoaderOnConfirm:!1,showCancelButton:!1,showCloseButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,customClass:"swal-custom-class",confirmButtonText:$close_botton_text,cancelButtonText:$cancel_botton_text,preConfirm:function(t){return new Promise(function(e,a){t===!0&&e()})}}).then(function(t){},function(t){})["catch"](swal.noop)},error:function(t){$("#popup").hide()}})}),$(document).on("click",'[data-request="add-card"]',function(){$("#popup").show(),$(".alert").remove(),$(".has-error").removeClass("has-error"),$(".help-block").remove();var t=$(this),e=t.data("target"),a=$(e).attr("action"),o=$(e).attr("method"),n=new FormData($(e)[0]);o||(o="get"),$.ajax({url:a,data:n,cache:!1,type:o,dataType:"json",contentType:!1,processData:!1,success:function(e){$("#popup").hide(),e.status===!0?($(t.data("content")).html(e.data.html),t.data("callback")&&$(t.data("callback")).trigger("click"),t.data("dismiss")&&$(t.data("dismiss")).modal("toggle"),1==e.redirect&&(window.location=window.location)):(e.message.length>0&&$(".messages").html(e.message),Object.size(e.data)>0&&show_validation_error(e.data))}})}),$('[data-request="paginate"]').length>0&&$('[data-request="paginate"]').trigger("click"),$(".proposal-found-then > div").length<=0&&$(".not-found-then").hide(),setTimeout(function(){"undefined"!=typeof fancybox&&$(".fancybox").length>0&&$(".fancybox").fancybox({padding:0,title:!1,type:"image",fitToView:!0,autoSize:!0,helpers:{overlay:{locked:!1}},beforeLoad:function(){$("body").addClass("no-transform")},afterClose:function(){$("body").removeClass("no-transform")}})},3e3),"undefined"!=typeof socket,$(document).on("click",'[data-request="status-request"]',function(){$(".alert").remove();var t=$(this).data("url"),e=$(this).data("ask"),a=confirm(e);return 1!=a?!1:($("#popup").show(),void $.ajax({method:"POST",url:t}).done(function(t){t.status===!0?LaravelDataTables.dataTableBuilder.draw():window.location=window.location}).always(function(){$("#popup").hide()}))})}),Object.size=function(t){var e,a=0;for(e in t)t.hasOwnProperty(e)&&a++;return a},function(t){t(window).on("load",function(){setTimeout(function(){t('[data-request="custom-scrollbar"]').length>0&&t('[data-request="custom-scrollbar"]').mCustomScrollbar()},200)})}(jQuery),$(window).on("load resize",function(){$("select").css("width","100%")});